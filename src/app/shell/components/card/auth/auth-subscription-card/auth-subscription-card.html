<nz-card [nzBordered]="false" class="tenant-card">
  <div class="flex items-start gap-6">
    <div class="flex-1">
      <!-- TÃªn Tenant + Status -->
      <h2 class="text-2xl font-bold flex items-center gap-3">
        Subscription ID: #{{ subscription().id }}
      </h2>
      <nz-descriptions [nzColumn]="2" class="mt-6" nzBordered nzSize="small">
        <nz-descriptions-item nzTitle="Subscription ID">
          #{{ subscription().id }}
        </nz-descriptions-item>
        <nz-descriptions-item nzTitle="Status">
          @switch (subscription().status) {

            @case ('ACTIVE') {
              <nz-tag nzColor="green">Active</nz-tag>
            }
            @case ('DRAFT') {
              <nz-tag nzColor="red">Draft</nz-tag>
            }
            @case ('PENDING') {
              <nz-tag nzColor="blue">Pending</nz-tag>
            }
            @case ('ENDED') {
              <nz-tag nzColor="yellow">Ended</nz-tag>
            }
            @case ('CANCEL') {
              <nz-tag nzColor="orange">Cancel</nz-tag>
            }
          }
        </nz-descriptions-item>
        <nz-descriptions-item nzTitle="Trial">
          <span class="font-medium text-orange-600">
            {{ subscription().trial }}
          </span>
        </nz-descriptions-item>
        <nz-descriptions-item nzTitle="Quantity">
          {{ subscription().quantity }}
        </nz-descriptions-item>
        <nz-descriptions-item nzTitle="Start Date">
          {{ subscription().startDate }}
        </nz-descriptions-item>
        <nz-descriptions-item nzTitle="End Date">
          {{ subscription().endDate }}
        </nz-descriptions-item>
        <nz-descriptions-item nzTitle="Cancel At End">
          <span class="font-medium text-orange-600">
            {{ subscription().cancelAtPeriodEnd }}
          </span>
        </nz-descriptions-item>
        <nz-descriptions-item nzTitle="Due Date">
          {{ subscription().dueDate }}
        </nz-descriptions-item>
        <nz-descriptions-item nzTitle="Created Date">
          {{ subscription().createdDate }}
        </nz-descriptions-item>
        <nz-descriptions-item nzTitle="Last Modified">
          {{ subscription().modifiedDate }}
        </nz-descriptions-item>
        <nz-descriptions-item nzTitle="Metadata">
          <pre>{{ metadataObject | json }}</pre>
        </nz-descriptions-item>
      </nz-descriptions>


      <!-- Actions -->
      <div class="mt-8 flex flex-wrap gap-3">
        <button (click)="onDelete()" class="!inline-flex !items-center"
                nz-button nzDanger>
          <span nz-icon nzType="delete"></span>
          Delete Subscription
        </button>
      </div>
      @if (subscription().subscriber) {
        <div class="mt-10">
          <h3 class="text-xl font-semibold mb-6 flex items-center gap-3">
            <span nz-icon nzType="team" class="text-blue-600"></span>
            Subscriber of this Subscription ({{ subscription().subscriber.name }})
          </h3>
          <div class="grid grid-cols-1 gap-6">
            <app-auth-subscriber-dto-card [subscriber]="subscription().subscriber"></app-auth-subscriber-dto-card>
          </div>
        </div>
      } @else {
        <div class="mt-10 text-center text-gray-500 py-8">
          <nz-icon nzType="team" nzTheme="outline" class="text-4xl opacity-50"></nz-icon>
          <p class="mt-3">No subscriber in this Subscription yet.</p>
        </div>
      }
      @if (subscription().price) {
        <div class="mt-10">
          <h3 class="text-xl font-semibold mb-6 flex items-center gap-3">
            <span nz-icon nzType="exception" class="text-blue-600"></span>
            Price of this Subscription (#{{ subscription().price.id }})
          </h3>
          <div class="grid grid-cols-1 gap-6">
            <app-auth-price-dto-card [price]="subscription().price"></app-auth-price-dto-card>
          </div>
        </div>
      } @else {
        <div class="mt-10 text-center text-gray-500 py-8">
          <nz-icon nzType="exception" nzTheme="outline" class="text-4xl opacity-50"></nz-icon>
          <p class="mt-3">No price in this Subscription yet.</p>
        </div>
      }
      <!--      phan invoices-->
      @if (subscription().invoices?.length) {
        <div class="mt-10">
          <h3 class="text-xl font-semibold mb-6 flex items-center gap-3">
            <span nz-icon nzType="file-done" class="text-blue-600"></span>
            Invoices in this Subscription ({{ subscription().invoices.length }})
          </h3>
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            @for (inv of subscription().invoices; track inv.id; let last = $last) {
              <div
                [class.lg:col-span-2]="subscription().invoices.length % 2 === 1 && last"
              >
                <app-auth-invoice-dto-card
                  (planRemove)="onInvoiceRemoved($event)"
                  [removable]="false"
                  [numberOfColumn]="1"
                  [invoice]="inv">
                </app-auth-invoice-dto-card>
              </div>
            }
          </div>

        </div>
      } @else {
        <div class="mt-10 text-center text-gray-500 py-8">
          <nz-icon nzType="file-done" nzTheme="outline" class="text-4xl opacity-50"></nz-icon>
          <p class="mt-3">No invoice in this subscription yet.</p>
        </div>
      }

    </div>
  </div>
</nz-card>
